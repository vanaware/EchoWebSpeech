<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Echo Web Speech</title>

<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="icon-32.png">
<link rel="icon" type="image/png" sizes="16x16" href="icon-16.png">

  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#ffffff" />

  <style>
    :root {
      --bg: #ffffff;
      --card: #f4f4f4;
      --text: #111111;
      --accent: #2563eb;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg: #111111;
        --card: #1e1e1e;
        --text: #ffffff;
        --accent: #2a2a2a;
      }
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, sans-serif;
      background: var(--bg);
      color: var(--text);
      display: flex;
      flex-direction: row;
      padding: 0;
    }

    .sidebar {
      position: fixed;
      left: 0;
      top: 0;
      width: 280px;
      height: 100vh;
      background: var(--card);
      border-right: 1px solid rgba(0,0,0,0.1);
      overflow-y: auto;
      padding: 20px;
      z-index: 1000;
      transition: transform 0.3s ease;
    }

    .sidebar h2 {
      margin-top: 0;
      font-size: 18px;
      margin-bottom: 20px;
    }

    .sidebar-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .sidebar-divider {
      height: 1px;
      background: rgba(0,0,0,0.15);
      margin: 20px 0;
    }

    .sidebar-section-title {
      font-weight: 600;
      font-size: 16px;
      margin-bottom: 12px;
      margin-top: 10px;
    }

    .search-box {
      width: 100%;
      padding: 10px;
      border: 1px solid rgba(0,0,0,0.1);
      border-radius: 8px;
      background: var(--bg);
      color: var(--text);
      font-size: 14px;
      margin-bottom: 12px;
      font-family: system-ui, -apple-system, sans-serif;
    }

    .search-box:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(37, 99, 235, 0.1);
    }

    .sidebar-item {
      padding: 12px;
      margin-bottom: 8px;
      background: var(--bg);
      border-radius: 8px;
      cursor: pointer;
      transition: 0.2s;
      font-size: 14px;
      border: 1px solid rgba(0,0,0,0.05);
    }

    .sidebar-item:hover {
      background: rgba(37, 99, 235, 0.1);
      border-color: var(--accent);
    }

    .sidebar-item.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    .sidebar-day-separator {
      margin: 16px 0 12px 0;
      padding: 10px 0;
      text-align: center;
      font-weight: 600;
      font-size: 14px;
      color: var(--text);
      border-top: 1px solid rgba(0,0,0,0.1);
      border-bottom: none;
      background: transparent;
      cursor: default;
      pointer-events: none;
      border-radius: 0;
      border: none;
    }

    .sidebar-day-separator::before {
      content: "";
      display: block;
      height: 1px;
      background: rgba(0,0,0,0.1);
      margin-bottom: 10px;
    }

    .menu-toggle {
      display: none;
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 999;
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 10px 12px;
      cursor: pointer;
      align-items: center;
      justify-content: center;
    }

    .menu-toggle:hover {
      opacity: 0.85;
    }

    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      width: 100%;
      margin-left: 280px;
      min-height: 100vh;
    }

    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
      }

      .sidebar.open {
        transform: translateX(0);
      }

      .menu-toggle {
        display: flex;
      }

      .main-content {
        margin-left: 0;
        padding: 20px 15px;
        padding-top: 70px;
      }
    }

    h1 {
      margin-bottom: 10px;
      margin-top: 0;
    }

    .day-nav,
    .phrase-nav {
      display: flex;
      align-items: center;
      gap: 15px;
      margin: 15px 0;
    }

    button {
      background: var(--accent);
      color: white;
      border: none;
      border-radius: 12px;
      padding: 10px 16px;
      font-size: 16px;
      cursor: pointer;
      transition: 0.2s;
    }

    button:hover {
      opacity: 0.85;
    }

    #card {
      background: var(--card);
      padding: 25px;
      border-radius: 18px;
      width: 100%;
      max-width: 500px;
      text-align: center;
      box-shadow: 0 5px 20px rgba(0,0,0,0.08);
    }

    #trad {
      font-size: 28px;
      font-weight: bold;
    }

    #simp {
      font-size: 20px;
      opacity: 0.7;
    }

    #br {
      font-size: 18px;
      margin-top: 10px;
    }

    #pt {
      font-size: 16px;
      margin-top: 10px;
      opacity: 0.8;
    }

    #feedback {
      margin-top: 20px;
      font-weight: bold;
      font-size: 18px;
      min-height: 24px;
      text-align: center;
    }

    .controls {
      margin-top: 15px;
      display: flex;
      gap: 15px;
    }

    .controls button {
  background: var(--card);
  color: var(--text);
  border: 1px solid rgba(0,0,0,0.1);
  border-radius: 14px;
  padding: 12px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.controls button:hover {
  background: rgba(0,0,0,0.05);
}

button.record {
  color: #c62828; /* vermelho elegante */
  border: 1px solid rgba(198,40,40,0.3);
}

button.record:hover {
  background: rgba(198,40,40,0.08);
}

footer {
  margin-top: auto;
  padding: 8px 20px;
  text-align: center;
  border-top: 1px solid rgba(0,0,0,0.1);
  background: var(--card);
  font-size: 14px;
  color: var(--text);
}

footer a {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  color: var(--text);
  text-decoration: none;
  transition: opacity 0.2s;
}

footer a:hover {
  opacity: 0.8;
  text-decoration: underline;
}

footer svg {
  width: 18px;
  height: 18px;
  display: inline-block;
}

#rate-control {
  margin-top: 20px;
  padding: 15px 20px;
  background: var(--card);
  border-radius: 12px;
  display: flex;
  align-items: center;
  gap: 15px;
  width: 100%;
  max-width: 500px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}

#rate-control label {
  font-weight: 600;
  font-size: 14px;
  white-space: nowrap;
  color: var(--text);
}

#rate-control input[type="range"] {
  flex: 1;
  height: 6px;
  border-radius: 3px;
  background: rgba(0,0,0,0.1);
  outline: none;
  -webkit-appearance: none;
  appearance: none;
  cursor: pointer;
}

#rate-control input[type="range"]::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: var(--accent);
  cursor: pointer;
  transition: 0.2s;
}

#rate-control input[type="range"]::-webkit-slider-thumb:hover {
  transform: scale(1.15);
}

#rate-control input[type="range"]::-moz-range-thumb {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: var(--accent);
  cursor: pointer;
  border: none;
  transition: 0.2s;
}

#rate-control input[type="range"]::-moz-range-thumb:hover {
  transform: scale(1.15);
}

#rate-value {
  font-weight: 600;
  font-size: 14px;
  color: var(--text);
  min-width: 30px;
  text-align: center;
}

@media (max-width: 768px) {
  #rate-control {
    padding: 12px 15px;
    gap: 12px;
  }
}

#pt-mode-input,
#free-mode-input {
  width: 100%;
  max-width: 500px;
  padding: 20px;
  background: var(--card);
  border: 1px solid rgba(0,0,0,0.1);
  border-radius: 18px;
  font-size: 32px;
  font-weight: bold;
  text-align: center;
  color: var(--text);
  font-family: system-ui, -apple-system, sans-serif;
  box-shadow: 0 5px 20px rgba(0,0,0,0.08);
  transition: 0.2s;
}

#pt-mode-input:focus,
#free-mode-input:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 5px 20px rgba(37, 99, 235, 0.2);
}

#pt-mode-input::placeholder,
#free-mode-input::placeholder {
  color: rgba(0,0,0,0.3);
}

@media (prefers-color-scheme: dark) {
  #pt-mode-input::placeholder,
  #free-mode-input::placeholder {
    color: rgba(255,255,255,0.3);
  }
}

#translation-container {
  width: 100%;
  max-width: 520px;
  display: none;
  gap: 10px;
  margin-bottom: 15px;
}

    /* Banner discreto de compatibilidade (aparece quando alguma API estÃ¡ ausente) */
    #compat-banner {
      position: fixed;
      right: 12px;
      bottom: 12px;
      background: rgba(0,0,0,0.65);
      color: #fff;
      padding: 8px 10px;
      border-radius: 10px;
      font-size: 12px;
      z-index: 2000;
      display: none;
      align-items: center;
      gap: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.25);
      max-width: 260px;
      line-height: 1;
    }

    #compat-banner .compat-close {
      background: transparent;
      border: none;
      color: rgba(255,255,255,0.85);
      font-size: 12px;
      padding: 2px 6px;
      border-radius: 6px;
      cursor: pointer;
      margin-left: 6px;
    }

    #compat-banner .compat-close:hover {
      background: rgba(255,255,255,0.06);
    }

#translate-btn {
  background: var(--accent);
  color: white;
  border: none;
  border-radius: 12px;
  padding: 10px 16px;
  font-size: 14px;
  cursor: pointer;
  transition: 0.2s;
  white-space: nowrap;
  font-weight: 600;
}

#translate-btn:hover {
  opacity: 0.85;
}

#translate-btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

#free-mode-input {
  width: 100%;
  max-width: 500px;
  padding: 20px;
  background: var(--card);
  border: 1px solid rgba(0,0,0,0.1);
  border-radius: 18px;
  font-size: 32px;
  font-weight: bold;
  text-align: center;
  color: var(--text);
  font-family: system-ui, -apple-system, sans-serif;
  box-shadow: 0 5px 20px rgba(0,0,0,0.08);
  transition: 0.2s;
}

#free-mode-input:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 5px 20px rgba(37, 99, 235, 0.2);
}

#free-mode-input::placeholder {
  color: rgba(0,0,0,0.3);
}

@media (prefers-color-scheme: dark) {
  #free-mode-input::placeholder {
    color: rgba(255,255,255,0.3);
  }
}
  </style>
</head>

<body>

  <!-- BotÃ£o de Menu (aparece em telas pequenas) -->
  <button class="menu-toggle" id="menuToggle" aria-label="Menu">
    <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2">
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </button>

  <!-- Sidebar com lista de frases -->
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-list" style="margin-bottom: 12px;">
      <div id="free-mode-btn" class="sidebar-item" style="cursor: pointer; display: none;">
        Modo Livre
      </div>
    </div>
    <h2><span id="sidebarDay">Modo Livre</span></h2>
    <ul class="sidebar-list" id="phraseList"></ul>
    
    <div class="sidebar-divider"></div>
    
    <div class="sidebar-section-title">Todos</div>
    <input type="text" id="searchBox" class="search-box" placeholder="ðŸ” Pesquisar...">
    <ul class="sidebar-list" id="allPhrasesList"></ul>
  </aside>

  <!-- ConteÃºdo Principal -->
  <div class="main-content">
    <h1>Echo Web Speech</h1>

    <!-- NavegaÃ§Ã£o de Dia -->
    <div class="day-nav">
      <button id="prevDay" aria-label="Dia anterior">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="11 17 6 12 11 7"></polyline>
          <line x1="18" y1="17" x2="13" y2="12"></line>
          <line x1="18" y1="7" x2="13" y2="12"></line>
        </svg>
      </button>

      <span id="dayTitle"></span>

      <button id="nextDay" aria-label="PrÃ³ximo dia">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="13 7 18 12 13 17"></polyline>
          <line x1="6" y1="7" x2="11" y2="12"></line>
          <line x1="6" y1="17" x2="11" y2="12"></line>
        </svg>
      </button>
    </div>

    <!-- Modo Livre (Dia 0) -->
    <div id="translation-container">
      <input type="text" id="pt-mode-input" placeholder="Escreva em portuguÃªs..." />
      <button id="translate-btn">Traduzir</button>
    </div>
    <input type="text" id="free-mode-input" placeholder="Escreva a palavra em chinÃªs..." />

    <!-- Card Principal -->
    <div id="card">
      <div id="trad"></div>
      <div id="simp"></div>
      <div id="br"></div>
      <div id="pt"></div>
    </div>

    <!-- NavegaÃ§Ã£o de Frase -->
    <div class="phrase-nav">
      <button id="prevPhrase" aria-label="Frase anterior">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
      </button>

      <button id="nextPhrase" aria-label="PrÃ³xima frase">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </button>
    </div>

    <!-- Controles -->
    <div class="controls">
      <button id="playBtn" aria-label="Ouvir">
        <svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor">
          <polygon points="8,5 19,12 8,19"></polygon>
        </svg>
      </button>

      <button id="recBtn" class="record" aria-label="Falar">
        <svg viewBox="0 0 24 24" width="22" height="22" fill="currentColor">
          <circle cx="12" cy="12" r="8"></circle>
        </svg>
      </button>
    </div>

    <div id="feedback"></div>

    <!-- Banner discreto de compatibilidade (inserido pelo app.js) -->
    <div id="compat-banner" role="status" aria-live="polite">
      <span id="compat-text"></span>
      <button class="compat-close" id="compat-close" aria-label="Fechar">âœ•</button>
    </div>

    <div id="rate-control">
      <label for="rate">Velocidade:</label>
      <input type="range" min="0.5" max="2" value="1" step="0.1" id="rate" />
      <span id="rate-value">1.0x</span>
    </div>

    <footer>
      <a href="https://github.com/vanaware/EchoWebSpeech" target="_blank" rel="noopener noreferrer">
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.768.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v 3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
        </svg>
        vanaware/EchoWebSpeech
      </a>
    </footer>
  </div>

  <!-- Script principal -->
  <script src="app.js" defer></script>

  <!-- Registro do Service Worker -->
  <script>
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("sw.js")
        .catch(err => console.log("SW erro:", err));
    }
  </script>

</body>
</html>